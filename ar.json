{
  "copilot_action_name": "LINUX-DETECT-PERSISTENCE-STARTUP-INJECTION-COPILOT-ACTION",
  "description": "Scans system-wide and user-specific startup scripts for suspicious persistence techniques and potential malicious injections. Detects signs of reverse shells, encoded payloads, remote downloads, crypto miners, environment hijacking, and prompt traps. Assigns severity levels based on findings and supports optional auto-remediation by commenting out malicious lines. Produces structured NDJSON output, including detected issues, severity, recent modification status, applied remediations, and backup paths. Writes results atomically to the Active Response log with .new fallback if locked.",
  "technology": "Linux",
  "icon": "linux",
  "script_parameters": [
    {
      "name": "RECENT_DAYS",
      "type": "integer",
      "required": false,
      "description": "Number of days to consider files as recently modified.",
      "default": 90
    },
    {
      "name": "HASH_ALL",
      "type": "boolean",
      "required": false,
      "description": "If set to 1, compute SHA256 hashes for all scanned files, even if clean.",
      "default": false
    },
    {
      "name": "FIX",
      "type": "boolean",
      "required": false,
      "description": "If enabled (1 or --fix), automatically comment out malicious lines and create backups.",
      "default": false
    },
    {
      "name": "ARLog",
      "type": "string",
      "required": false,
      "description": "Active Response NDJSON output path (atomic overwrite; falls back to .new if locked).",
      "default": "/var/ossec/active-response/active-responses.log"
    },
    {
      "name": "LogPath",
      "type": "string",
      "required": false,
      "description": "Path to the rotating human-readable script log.",
      "default": "/tmp/Detect-Persistence-Startup-Injection-script.log"
    },
    {
      "name": "LogMaxKB",
      "type": "integer",
      "required": false,
      "description": "Maximum size of the log file (KB) before rotation.",
      "default": 100
    },
    {
      "name": "LogKeep",
      "type": "integer",
      "required": false,
      "description": "Number of rotated log files to keep.",
      "default": 5
    }
  ],
  "repo_url": "https://github.com/socfortress/LINUX-DETECT-PERSISTENCE-STARTUP-INJECTION-COPILOT-ACTION",
  "script_name": "Detect-Persistence-Startup-Injection.sh",
  "version": "1.0.0",
  "last_updated": "2025-08-23T00:00:00Z"
}
